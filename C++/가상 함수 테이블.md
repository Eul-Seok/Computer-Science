# 가상 함수 테이블 (Virtual Function Table, V-Table)

V-Table(가상 함수 테이블)은 C++에서 <b>런타임 다형성(Runtime Polymorphism)</b>을 구현하기 위한 핵심적인 내부 메커니즘입니다.

---

## 1. V-Table의 생성

클래스에 하나 이상의 <b>가상 함수(`virtual`)</b>가 선언되면, 컴파일러는 해당 클래스에 대한 V-Table을 자동으로 생성합니다. 이 테이블은 해당 클래스의 가상 함수들이 실제로 어떤 함수를 가리키는지에 대한 **함수 포인터들의 배열**입니다.

## 2. 동작 원리: vptr과 동적 디스패치

-   **vptr (가상 함수 포인터)**
    -   가상 함수를 가진 클래스의 객체가 생성될 때, 해당 객체는 자신 클래스의 V-Table을 가리키는 숨겨진 포인터인 `vptr`을 멤버로 갖게 됩니다.

-   **런타임 함수 호출 (동적 디스패치, Dynamic Dispatch)**
    1.  프로그램이 가상 함수를 호출하면, 컴파일 타임에 어떤 함수를 실행할지 결정하지 않습니다.
    2.  대신 런타임에 객체의 `vptr`을 따라가 V-Table에 접근합니다.
    3.  V-Table에서 호출하려는 가상 함수에 해당하는 실제 함수 주소를 찾아 그 함수를 실행합니다.

디스패치란 "어떤 함수를 호출할지 결정하고 실행하는 과정"을 뜻하며, 
이러한 메커니즘 덕분에, 기반 클래스의 포인터나 참조를 통해 파생 클래스의 오버라이딩된 함수를 정확하게 호출할 수 있습니다.

## 3. 코드 예시

```cpp
class Base
{
public:
    // 가상 함수 선언
    virtual void print()
    {
        // Base의 print 함수
    }
};

class Derived : public Base
{
public:
    // 가상 함수 오버라이딩
    virtual void print() override
    {
        // Derived의 print 함수
    }
};

// 기반 클래스 포인터로 파생 클래스 객체를 가리킴
Base* ptr = new Derived();

// ptr은 Base 타입이지만, vptr을 통해 Derived의 V-Table에 접근하여
// 최종적으로 Derived의 print() 함수가 호출된다.
ptr->print(); // "동적 디스패치" 발생
```

## 4. 핵심 역할 및 요약

V-Table은 C++에서 런타임 다형성을 안전하고 효율적으로 구현하기 위한 핵심 메커니즘입니다. 이 구조 덕분에 개발자는 유연한 인터페이스를 설계하고 확장성 있는 객체지향 프로그램을 만들 수 있습니다.