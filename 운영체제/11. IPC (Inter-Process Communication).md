# 11. IPC (Inter-Process Communication)

## 1. IPC란 무엇이며, 왜 필요한가?

<b>IPC(Inter-Process Communication)</b>는 단어 그대로 **프로세스 간 통신**을 의미합니다. 운영체제는 각 프로세스에 독립적인 메모리 공간을 할당하여 안정성을 보장하며, 이 때문에 하나의 프로세스는 다른 프로세스의 메모리 영역에 직접 접근할 수 없습니다.

하지만 여러 프로세스가 협력하여 하나의 작업을 처리해야 하는 경우가 많으므로, 이들 간에 데이터를 주고받거나 작업을 동기화할 수 있는 통신 방법이 필요합니다. 이때 사용되는 것이 바로 IPC입니다.

## 2. IPC 방식의 종류

IPC 방식은 크게 두 가지 접근 방식으로 나눌 수 있습니다.

1.  **메시지 전달 (Message Passing):** 프로세스 간 직접 통신하지 않고, 운영체제(커널)가 제공하는 통신 채널을 통해 메시지를 주고받는 방식입니다. 구현이 비교적 간단하고 안전하지만, 커널을 거치므로 오버헤드가 발생할 수 있습니다.
    *   **대표 기법:** 파이프(Pipe), 메시지 큐(Message Queue), 소켓(Socket), 시그널(Signal)

2.  **공유 메모리 (Shared Memory):** 여러 프로세스가 접근할 수 있는 공용 메모리 공간을 만들어, 해당 공간을 통해 직접 데이터를 주고받는 방식입니다. 커널을 거치지 않아 매우 빠르지만, 동시 접근으로 인한 충돌 문제가 발생할 수 있어 별도의 동기화 메커니즘이 반드시 필요합니다.

## 3. 메시지 전달 기반 IPC

#### 파이프 (Pipe)

두 프로세스를 연결하는 단방향 통신 채널입니다. 한쪽 끝에서는 데이터를 쓰기만 하고, 다른 쪽 끝에서는 읽기만 할 수 있습니다. 주로 부모-자식 프로세스처럼 연관된 프로세스 간 통신에 사용됩니다.

*   **특징:** 스트림 기반이며, 동기적 특성이 강합니다. (예: 셸에서 `ls | grep "pattern"`)
*   **종류:** 익명 파이프(Anonymous Pipe)와 명명된 파이프(Named Pipe)가 있습니다.

#### 메시지 큐 (Message Queue)

운영체제가 관리하는 "메시지 보관함"을 통해 데이터를 주고받는 방식입니다. 보내는 쪽은 메시지를 큐에 넣고, 받는 쪽은 큐에서 메시지를 꺼내가는 비동기 통신에 유리합니다.

*   **특징:** 메시지 단위로 통신하며, 관련 없는 프로세스 간에도 통신할 수 있습니다.

#### 소켓 (Socket)

네트워크를 통해 서로 다른 컴퓨터에 있는 프로세스 간에도 통신할 수 있게 해주는 양방향 통신 인터페이스입니다.

*   **특징:** 클라이언트-서버 모델의 기반이며, 가장 유연하지만 설정이 복잡하고 속도가 가장 느립니다.

#### 시그널 (Signal)

운영체제가 프로세스에게 특정 이벤트가 발생했음을 알려주는 간단한 형태의 메시지입니다.

*   **특징:** 복잡한 데이터를 전달하기보다는, 특정 상황(예: `Ctrl+C` 입력, 자식 프로세스 종료)을 알리는 데 사용됩니다.

## 4. 공유 메모리 기반 IPC

#### 장점: 가장 빠른 속도

공유 메모리는 데이터를 주고받을 때 운영체제를 거치지 않고, 여러 프로세스가 자신의 주소 공간처럼 동일한 메모리에 직접 접근합니다. 이로 인해 데이터 복사 과정이 생략되어 IPC 기법 중 가장 속도가 빠릅니다.

#### 단점: 동기화 문제

여러 프로세스가 동시에 같은 메모리 영역에 접근하면 <b>경쟁 상태(Race Condition)</b>가 발생하여 데이터가 손상될 수 있습니다. 따라서 `세마포어(Semaphore)`나 `뮤텍스(Mutex)` 같은 동기화 도구를 반드시 함께 사용하여 접근 순서를 제어해야 합니다.

## 5. IPC와 동기화

IPC의 목적은 단순히 데이터를 전달하는 것을 넘어, 여러 프로세스가 **안전하게 협력**하도록 만드는 데 있습니다. 특히 공유 메모리 방식처럼 여러 프로세스가 공유 자원에 동시에 접근할 수 있는 경우, 동기화는 데이터의 **일관성**과 **안정성**을 보장하는 필수 요소입니다.

*   **세마포어(Semaphore):** 공유 자원에 접근할 수 있는 프로세스의 최대 허용 개수를 나타내는 정수 값입니다. 자원이 여러 개일 때 주로 사용됩니다.
*   **뮤텍스(Mutex):** 오직 하나의 프로세스(또는 스레드)만 공유 자원에 접근할 수 있도록 하는 잠금(Lock) 메커니즘입니다. 자원이 하나일 때 사용됩니다.

## 6. IPC와 스레드

프로세스와 스레드는 통신 방식에서 근본적인 차이가 있습니다.

*   **프로세스 간 통신:** 독립된 메모리 공간을 가지므로, 반드시 운영체제가 제공하는 **IPC**를 사용해야 합니다.
*   **스레드 간 통신:** 같은 프로세스 내의 메모리(데이터, 힙 영역 등)를 공유하므로, 별도의 IPC 없이 전역 변수나 힙 메모리를 통해 직접 통신할 수 있습니다. 다만, 이 경우에도 공유 데이터에 대한 경쟁 상태를 막기 위한 **동기화(뮤텍스, 세마포어 등)는 필수**입니다.

## 7. IPC와 시스템 콜

공유 메모리를 제외한 대부분의 IPC 기법은 **시스템 콜**을 통해 구현됩니다. (예: `pipe()`, `msgget()`, `socket()`)

사용자 프로세스가 IPC를 위해 시스템 콜을 호출하면, 사용자 모드에서 커널 모드로의 전환이 발생하며 이 과정에서 **문맥 전환 비용**이 발생합니다. 이것이 커널을 거치는 IPC 방식에 오버헤드가 존재하는 주된 이유입니다.

## 8. IPC와 보안

IPC는 프로세스 간 자원 공유를 가능하게 하므로, 보안 관점에서 신중하게 사용되어야 합니다. 특히 여러 프로세스가 직접 접근하는 공유 메모리 방식은 접근 권한 설정이 매우 중요합니다.

권한 설정이 허술하거나 인증 절차가 없다면, 악의적인 프로세스가 민감한 데이터를 탈취하거나 시스템을 교란하는 통로가 될 수 있습니다. 따라서 IPC를 사용할 때는 반드시 최소한의 접근 권한을 부여하고, 통신하는 프로세스 간의 신뢰성을 확인하는 절차를 고려해야 합니다.

---